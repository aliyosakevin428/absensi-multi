import{u as L,r as m,b as B,j as e,L as T,a as E}from"./app-Df3mbPUi.js";import{B as N}from"./button-9WYi6K-0.js";import{C as k,a as R,b as F,c as H,d as K}from"./card-Dc5LHktC.js";import{A as M}from"./app-layout-Cdpsr00c.js";import{t as w}from"./utils-638cp2NO.js";import $ from"./upload-media-Br8QwslJ.js";/* empty css            */import"./index-CA9Kvjwe.js";import"./theme-toggler-C-WERlBf.js";import"./sheet-Ulit7ETd.js";import"./index-uZWYb__A.js";import"./index-DbH9gTKF.js";import"./index-BSfUgiQX.js";import"./index-DCCetT5R.js";import"./index-BRG9LdGI.js";import"./createLucideIcon-SMMqF0gJ.js";import"./index-BqPEmoZ3.js";import"./index-DF4tnvgq.js";import"./index-OP-2HeKn.js";import"./index-EwimxF0w.js";import"./app-logo-BxA-0lpz.js";import"./app-logo-icon-S37ZxhZz.js";import"./avatar-C2HoZ03v.js";import"./settings-Biukm5Ub.js";import"./chevrons-up-down-Dcdp5jj5.js";import"./book-open-C22VND1L.js";import"./newspaper-DjC88fLo.js";import"./chevron-right-KX34Omcy.js";import"./input-Cg5Qh1OS.js";const be=({attendance:a})=>{var x,u,b,j;const{props:y}=L(),v=(((x=y.auth)==null?void 0:x.roles)||[]).some(s=>s.toLowerCase()==="superadmin"||s.toLowerCase()==="admin"),[r,h]=m.useState([]),[S]=m.useState(a.media),C=s=>{h(t=>t.includes(s)?t.filter(i=>i!==s):[...t,s])},p=a.status;let o=p,n="text-gray-500";switch(p){case"Rencana":o="Rencana",n="text-blue-500";break;case"Sedang Berlangsung":o="Sedang berlangsung",n="text-yellow-500";break;case"Sudah Terlaksana":o="Sudah terlaksana",n="text-green-600";break;case"Dibatalkan":o="Dibatalkan",n="text-red-600";break}const[d,A]=m.useState(()=>{const s={};return a.users.forEach(t=>{s[t.id]=Array.isArray(t.attendancePositions)?t.attendancePositions.map(i=>i.position_id):[]}),s}),D=(s,t)=>{const i=d[s]||[],l=i.includes(t)?i.filter(c=>c!==t):[...i,t];A(c=>{const f={...c,[s]:l};return g.setData("positions",f),f})},g=B({positions:d}),P=()=>{g.post(route("attendances.updatePositionsAll",a.id),{preserveScroll:!0,onSuccess:()=>{w.success("Absensi berhasil diubah"),window.location.href=route("attendance.index")}})},_=()=>{console.log("Delete media dengan id:",r),E.delete(route("attendances.media.destroyBulk",a.id),{data:{ids:r},preserveScroll:!0,onSuccess:()=>{w.success("Media berhasil dihapus"),h([]),window.location.href=route("attendance.show",a.id)}})};return console.log(a.media),e.jsxs(M,{title:"Detail Absensi",description:"Detail absensi acara dihadiri oleh anggota",children:[e.jsx(k,{children:e.jsxs(R,{children:[e.jsx(F,{className:"flex py-2",children:(u=a.event)==null?void 0:u.name}),e.jsxs(H,{className:"flex flex-col gap-5",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tanggal Acara: "}),(b=a.event)!=null&&b.waktu_kegiatan?new Date(a.event.waktu_kegiatan).toLocaleString("id-ID",{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status: "}),e.jsx("span",{className:`font-semibold ${n}`,children:o})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Keterangan Absen: "}),((j=a.absent_reason)==null?void 0:j.name)??"-"]})]})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"mb-5 text-lg font-bold",children:"Anggota yang Terdaftar:"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.users.map(s=>{var t;return e.jsx(k,{className:"p-4 shadow-sm",children:e.jsxs(K,{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email}),e.jsxs("div",{className:"mt-4",children:[e.jsx("strong",{children:"Posisi:"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 md:grid-cols-2",children:(t=s.positions)!=null&&t.length?s.positions.map(i=>{var l;return e.jsxs("label",{className:"flex items-center gap-2 rounded-md border p-2 hover:!bg-secondary hover:!text-foreground",children:[e.jsx("input",{type:"checkbox",checked:((l=d[s.id])==null?void 0:l.includes(i.id))||!1,onChange:()=>D(s.id,i.id)}),e.jsx("span",{className:"text-sm",children:i.name})]},i.id)}):e.jsx("p",{className:"text-sm text-gray-600",children:"Belum ada posisi"})})]})]})},s.id)})})]}),e.jsxs("div",{className:"mt-8 px-1 py-5",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Dokumentasi Acara:"}),e.jsx("div",{className:"grid grid-cols-2 gap-6 md:grid-cols-3 lg:grid-cols-4",children:S.map(s=>e.jsxs("label",{className:"group relative cursor-pointer overflow-hidden rounded-lg border bg-transparent shadow-sm",children:[e.jsx("input",{type:"checkbox",checked:r.includes(s.id),onChange:()=>C(s.id),className:"absolute top-2 left-2 z-10 h-4 w-4"}),e.jsx("img",{src:s.original_url,alt:s.file_name,className:`h-40 w-full object-cover transition group-hover:opacity-80 ${r.includes(s.id)?"opacity-70 ring-4 ring-blue-200":""}`}),e.jsx("div",{className:"truncate p-2 text-center text-sm text-foreground",children:s.file_name})]},s.id))}),r.length>0&&e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:_,className:"rounded-md bg-red-500 px-4 py-2 text-white shadow hover:bg-red-600",children:["Hapus ",r.length," File"]})})]}),e.jsx($,{attendance:a}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[v&&e.jsx(N,{className:"rounded-md bg-blue-500 px-3 py-1.5 text-sm text-white transition-colors hover:bg-blue-700",onClick:P,children:"Simpan"}),e.jsx(N,{className:"rounded-md bg-red-500 px-3 py-1.5 text-sm text-white transition-colors hover:bg-red-700",asChild:!0,children:e.jsx(T,{href:route("attendance.index"),method:"get",children:"Kembali"})})]})]})};export{be as default};

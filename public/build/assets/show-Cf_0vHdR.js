import{u as L,r as m,b as T,j as e,L as E,a as R}from"./app-DDfrCDLw.js";import{B as k}from"./button-BuJmk2yv.js";import{C as y,a as F,b as H,c as K,d as M}from"./card-DhK-uYKB.js";import{A as $}from"./app-layout-DoaucmDC.js";import{t as v}from"./utils-DtvnShxN.js";import z from"./upload-media-B2pYVkLn.js";/* empty css            */import"./index-CDw_WkRz.js";import"./theme-toggler-DMHlR7kB.js";import"./sheet-DbjZVO2o.js";import"./index-DVX8wpXH.js";import"./index-BHwy-fA2.js";import"./index-Ce5DCTkM.js";import"./index-CbWTgqZZ.js";import"./index-AldrL0yo.js";import"./createLucideIcon-Cqdb5Lwq.js";import"./index-fMFm6i8R.js";import"./index-Bruj9sp3.js";import"./index-GmTlfmzI.js";import"./index-CXYUVXWs.js";import"./app-logo-C8CWIidX.js";import"./app-logo-icon-Xf9aglSp.js";import"./avatar-DZlk431y.js";import"./settings-Bf47e1Rw.js";import"./chevrons-up-down-BDLww10V.js";import"./book-open-CK9VUjos.js";import"./newspaper-CWJrjsgo.js";import"./chevron-right-D3uXVjuE.js";import"./input-DsVsH6-y.js";const be=({attendance:a})=>{var u,b,j,f;const{props:w}=L(),h=((u=w.auth)==null?void 0:u.roles)||[],S=h.includes("Superadmin")||h.includes("admin"),[r,p]=m.useState([]),[C]=m.useState(a.media),A=s=>{p(t=>t.includes(s)?t.filter(i=>i!==s):[...t,s])},g=a.status;let o=g,n="text-gray-500";switch(g){case"Rencana":o="Rencana",n="text-blue-500";break;case"Sedang Berlangsung":o="Sedang berlangsung",n="text-yellow-500";break;case"Sudah Terlaksana":o="Sudah terlaksana",n="text-green-600";break;case"Dibatalkan":o="Dibatalkan",n="text-red-600";break}const[d,D]=m.useState(()=>{const s={};return a.users.forEach(t=>{s[t.id]=Array.isArray(t.attendancePositions)?t.attendancePositions.map(i=>i.position_id):[]}),s}),P=(s,t)=>{const i=d[s]||[],l=i.includes(t)?i.filter(c=>c!==t):[...i,t];D(c=>{const N={...c,[s]:l};return x.setData("positions",N),N})},x=T({positions:d}),_=()=>{x.post(route("attendances.updatePositionsAll",a.id),{preserveScroll:!0,onSuccess:()=>{v.success("Absensi berhasil diubah"),window.location.href=route("attendance.index")}})},B=()=>{console.log("Delete media dengan id:",r),R.delete(route("attendances.media.destroyBulk",a.id),{data:{ids:r},preserveScroll:!0,onSuccess:()=>{v.success("Media berhasil dihapus"),p([]),window.location.href=route("attendance.show",a.id)}})};return console.log(a.media),e.jsxs($,{title:"Detail Absensi",description:"Detail absensi acara dihadiri oleh anggota",children:[e.jsx(y,{children:e.jsxs(F,{children:[e.jsx(H,{className:"flex py-2",children:(b=a.event)==null?void 0:b.name}),e.jsxs(K,{className:"flex flex-col gap-5",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tanggal Acara: "}),(j=a.event)!=null&&j.waktu_kegiatan?new Date(a.event.waktu_kegiatan).toLocaleString("id-ID",{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status: "}),e.jsx("span",{className:`font-semibold ${n}`,children:o})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Keterangan Absen: "}),((f=a.absent_reason)==null?void 0:f.name)??"-"]})]})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"mb-5 text-lg font-bold",children:"Anggota yang Terdaftar:"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.users.map(s=>{var t;return e.jsx(y,{className:"p-4 shadow-sm",children:e.jsxs(M,{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email}),e.jsxs("div",{className:"mt-4",children:[e.jsx("strong",{children:"Posisi:"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 md:grid-cols-2",children:(t=s.positions)!=null&&t.length?s.positions.map(i=>{var l;return e.jsxs("label",{className:"flex items-center gap-2 rounded-md border p-2 hover:!bg-secondary hover:!text-foreground",children:[e.jsx("input",{type:"checkbox",checked:((l=d[s.id])==null?void 0:l.includes(i.id))||!1,onChange:()=>P(s.id,i.id)}),e.jsx("span",{className:"text-sm",children:i.name})]},i.id)}):e.jsx("p",{className:"text-sm text-gray-600",children:"Belum ada posisi"})})]})]})},s.id)})})]}),e.jsxs("div",{className:"mt-8 px-1 py-5",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Dokumentasi Acara:"}),e.jsx("div",{className:"grid grid-cols-2 gap-6 md:grid-cols-3 lg:grid-cols-4",children:C.map(s=>e.jsxs("label",{className:"group relative cursor-pointer overflow-hidden rounded-lg border bg-transparent shadow-sm",children:[e.jsx("input",{type:"checkbox",checked:r.includes(s.id),onChange:()=>A(s.id),className:"absolute top-2 left-2 z-10 h-4 w-4"}),e.jsx("img",{src:s.original_url,alt:s.file_name,className:`h-40 w-full object-cover transition group-hover:opacity-80 ${r.includes(s.id)?"opacity-70 ring-4 ring-blue-200":""}`}),e.jsx("div",{className:"truncate p-2 text-center text-sm text-foreground",children:s.file_name})]},s.id))}),r.length>0&&e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:B,className:"rounded-md bg-red-500 px-4 py-2 text-white shadow hover:bg-red-600",children:["Hapus ",r.length," File"]})})]}),e.jsx(z,{attendance:a}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[S&&e.jsx(k,{className:"rounded-md bg-blue-500 px-3 py-1.5 text-sm text-white transition-colors hover:bg-blue-700",onClick:_,children:"Simpan"}),e.jsx(k,{className:"rounded-md bg-red-500 px-3 py-1.5 text-sm text-white transition-colors hover:bg-red-700",asChild:!0,children:e.jsx(E,{href:route("attendance.index"),method:"get",children:"Kembali"})})]})]})};export{be as default};
